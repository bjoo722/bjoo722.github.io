<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>互動網格地圖</title>

  <!-- Leaflet 樣式 -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">

  <style>
    body { margin: 0; }
    #map { width: 100vw; height: 100vh; }

    /* 標籤樣式 */
    .grid-label {
      font-weight: bold;
      color: black;
      background-color: rgba(255,255,255,0.7);
      padding: 2px 4px;
      border-radius: 3px;
      font-size: 14px;
    }
  </style>
</head>
<body>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  // ====== 設定你的圖片 ======
  const 圖片名 = 'map.jpg';   // 上傳到 repo 的地圖圖片
  const 圖片寬 = 1852;       // 圖片實際寬度
  const 圖片高 = 1472;       // 圖片實際高度

  // 建立地圖
  const map = L.map('map', {
    crs: L.CRS.Simple,
    minZoom: -2
  });

  // 設定圖片範圍
  const bounds = [[1852, 1472], [圖片高, 圖片寬]];
  L.imageOverlay(圖片名, bounds).addTo(map);
  map.fitBounds(bounds);

  // ====== 網格設定 ======
  const 行數 = 12;  // Y 軸格數
  const 列數 = 16;  // X 軸格數
  const 格寬 = 圖片寬 / 列數;
  const 格高 = 圖片高 / 行數;

  // 繪製水平線
  for (let i = 0; i <= 行數; i++) {
    const y = i * 格高;
    L.polyline([[y, 0], [y, 圖片寬]], {color: 'gray', weight: 1}).addTo(map);
  }

  // 繪製垂直線
  for (let j = 0; j <= 列數; j++) {
    const x = j * 格寬;
    L.polyline([[0, x], [圖片高, x]], {color: 'gray', weight: 1}).addTo(map);
  }

  // ====== X 軸標籤 A,B,C... ======
  for (let j = 0; j <列數; j++) {
    const x = j * 格寬 + 格寬/2;
    L.marker([0, x], {icon: L.divIcon({
      className: 'grid-label',
      html: String.fromCharCode(65+j),
      iconSize: [20,20],
      iconAnchor: [10, -10]
    })}).addTo(map);
  }

  // ====== Y 軸標籤 1,2,3... ======
  for (let i = 0; i < 行數; i++) {
    const y = i * 格高 + 格高/2;
    L.marker([y, 0], {icon: L.divIcon({
      className: 'grid-label',
      html: (i+1).toString(),
      iconSize: [20,20],
      iconAnchor: [-10, 10]
    })}).addTo(map);
  }

  // ====== 範例標記 ======
  const 範例標記 = [
    {y: 600, x: 1000, text: '這裡是標記1'},
    {y: 300, x: 500, text: '這裡是標記2'}
  ];

  範例標記.forEach(p => {
    L.marker([p.y, p.x]).addTo(map)
      .bindPopup(p.text);
  });

  // ====== 點擊地圖新增標記 ======
  map.on('click', function(e){
    const y = e.latlng.lat;
    const x = e.latlng.lng;
    const popupText = `新標記: ${Math.round(y)}, ${Math.round(x)}`;
    L.marker([y, x]).addTo(map)
      .bindPopup(popupText)
      .openPopup();
  });

</script>

</body>
</html>
